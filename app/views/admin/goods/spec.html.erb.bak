<div>

	<ul class="nav nav-tabs">
		<%@good.good_specs.pluck(:spec_id).uniq.each_with_index do |spec_id,index|%>
			<li class="<%='active' if index == 0%>">
				<%=link_to Ecstore::Spec.find(spec_id).spec_name,"#spec_#{spec_id}",:"data-toggle"=>"tab"%>
			</li>
		<%end%>
	</ul>
	<div class="tab-content">
		<%@good.good_specs.pluck(:spec_id).uniq.each_with_index do |spec_id,index|%>
		<div class="tab-pane <%='active' if index == 0%>" id='<%="spec_#{spec_id}"%>'>
                	<table class="table table-bordered">
                		<thead>
                			<tr>
                				<th>规格值</th>
                				<th>关联商品图册图片</th>
                				<th>操作</th>
                			</tr>
                		</thead>
	                	<%@good.good_specs.where(:spec_id=>spec_id).pluck(:spec_value_id).uniq.each do |spec_value_id|%>
	                		
	                		<tr id='<%="spec_value_#{spec_value_id}"%>'>
	                			<td><%=( _spec_value = Ecstore::SpecValue.find(spec_value_id).spec_value)%></td>
	                			
	                			<td>--</td>
	                			<td>
	                				<%=link_to "展开","#",:class=>"expand" if expandable?(_spec_value)%>
	                          	</td>
	                		</tr>
	                		<%if expandable?(_spec_value)%>
	                		<tr>
	                			<td colspan="4">
	                				<div class="good-spec-header">
	                					<strong>可选规格</strong>
	                					&nbsp;&nbsp;&nbsp;
            							<%=link_to "+新增字段","javascript:void(0)",:'data-url'=>admin_spec_items_path,:class=>"add-spec-item-field"%>
            							<%=link_to "+添加选项","javascript:void(0);",:'data-url'=>add_spec_item_admin_good_path(@good,:spec_value_id=>spec_value_id),:class=>"add-spec-item"%>
	                				</div>
	                				<%=form_for :good_spec_items,:url=>update_spec_admin_good_path(@good),:method=>:put,:remote=>true do |f|%>
	                					<%=hidden_field_tag "spec_value_id",spec_value_id%>
		                				<ul class="good-spec-items" id='<%="good_spec_value_#{spec_value_id}"%>'>
		                					<%@good.good_spec_items.where(:spec_value_id=>spec_value_id).each do |item|%>
		                						<%=render :partial=>"admin/goods/spec_item",:locals=>{:item=>item}%>
		                					<%end%>
		                				</ul>
		                				<div class="actions">
		                					<%=f.submit "保存",:class=>"btn btn-primary",:disabled=>true%>
		                				</div>
	                				<%end%>
	                			</td>
	                		</tr>
	                		<%end%>
	                	<%end%>
                	</table>
                	
             </div>
		<%end%>
	</div>
</div>

<div>
	<div>共<%=@products.size%>件货品</div>
  	<table class="table table-bordered">
	<thead>
	<tr>
		<th>上架</th>
		<th>规格值</th>
		<th>货号</th>
		<th>库存</th>
		<th>销售价</th>
		<th>定金</th>
		<th>市场价</th>
		<th>重量</th>
		<th>货位</th>
	</tr>
	</thead>
	<tbody>
		<%@products.each do |product|%>
		<tr>
			<td><%=product.marketable=='true'? '是' : '否'%></td>
			<td><%=product.spec_info%></td>
			<td><%=product.bn%></td>
			<td><%=product.store%></td>
			<td><%=product.price%></td>
			<td>--</td>
			<td><%=product.mktprice%></td>
			<td><%=product.weight%></td>
			<td><%=product.store_place%></td>
		</tr>
		<%end%>
		
	</tbody>
</div>