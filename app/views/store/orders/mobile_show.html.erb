<style type="text/css">

    body{
        background: #ffffff;

    }
    .bottomdivs{
        display: none;
    }


    .status_text {
        font-family: "微软雅黑","宋体";
        display: inline-block;
        font-weight: normal;

        margin-left: 10%;
        line-height: 65px;
        line-height: 1.5;
        text-align: left;
        font-size: 24px;
        color: #ed145b;
    }
    .blue .pay_icon, .list_status .green .pay_icon {
        background-position: 0 -160px;
        width: 24px;
        height: 24px;
    }

    .pay_success {
        width: 65px;
        height: 65px;
        background-position: 0 0px;
    }
    .pay_icon {
        display: block;
        _display: inline;
        float: left;
        background: url(/assets/payment_status_icons.jpg) top left no-repeat;
    }
    .detail{
        border: 1px;
        width: 100%;
        padding: 5px;
        border: 1px solid #f0f1ff;
    }
    .ovalue{
        margin-left: 50%;

    }
    .pay_text{
        line-height: 3;
    }
    .btn-inverse{
        clear: both;
        width: 100%;
        color: #ffffff;
        background-color: #dd514c;

        background:#dd514c ;
        display: inline-block;
        margin-bottom: 0;
        font-weight: normal;
        text-align: center;
        vertical-align: middle;
        cursor: pointer;
        background-image: none;

        white-space: nowrap;
        padding: 0.625em 1em;
        border-radius: 2px;
        line-height: 1.2;
        /* font-size: 1.6rem; */
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        -o-user-select: none;
        user-select: none;
        -webkit-transition: width 0.15s;
        transition: width 0.15s;
    }

    .btn-inverse:hover{
        color: #ffffff;
        background-color: #dd514c;
        border-color: #ff0e1a;
        background:#ff0e1a ;
    }

</style>

<div class="">
  <%=form_for :payment,:url=>payments_path(:order_id=>@order.order_id),:method=>'post',:html=>{ :target=>"_blank" } do |f|%>
      <%=f.hidden_field :currency, :value=>"CNY" %>
      <%if @order.payment == "bcom"%>
          <%=f.hidden_field :memo, :value=>"持交通银行卡在线支付可享受订单金额95折优惠" %>
      <%end%>
      <br/>
      <div class="status_text">
        <span class="pay_icon pay_success "></span>
        <span class="pay_text">订单已经成功提交!</span>
      </div>

      <br/>
      <div class="list_status">

        <h2 class="blue" >
          <span class="pay_icon"></span>
          <span style="color: #0abede">以下订单尚未成功支付，请您尽快完成支付!</span>

        </h2>
      </div>


      <br/>
      <div class="showall">
        <div  class="detail" >
          <span class="span">	&nbsp; &nbsp; 订单编号:</span> <span style="margin-left: 40%" ><%=@order.order_id%></span>
        </div>

        <div class="detail" >
          <span class="span">	&nbsp; &nbsp; 支付金额:</span> <span id="final_pay" class="ovalue"><%#=@order.final_pay%>￥<%=@order.final_amount%>
           </span> </div>
        <br/>

        <span id="products_total" data-amount="<%=@order.products_total%>" style="display: none"></span>


        <div class="detail" >
          <span class="span">&nbsp; &nbsp; 	订单状态:</span> <span style=" color: #ed145b;" class="ovalue"><%=@order.order_status_text%></span>
        </div>


        <span id="pmts_total" class="hide" data-amount="<%=@order.pmts_total%>"></span>

        <hr>
        <div class="payment">
          <span class="span">&nbsp; &nbsp; 	支付方式:</span>
          <span class="title" style="color: #0abede"><%=payments[@order.payment][:name]%></span>
          <%if @order.status == 'active' && @order.pay_status == '0'%>
              <a href="#" class="change " style="margin-left: 30%" id="change_payment">更改支付方式 </a>
          <%end%>
          <hr>
          <div><%=payments[@order.payment][:extra].html_safe%></div>
        </div>

        <div class="payments " style="display: none" id="payment_choices">
          <h5>已选择的支付方式现修改为：</h5>

          <%if @order.part_pay?%>
              <label class="checkbox">
                <%=f.check_box :part_pay, { :checked=>true, :'data-amount'=>@order.part_pay.to_i,:id=>"advance" }, @order.part_pay.to_i, 0%> <b>预付款先支付</b>
                余额(<span>￥<%=@order.part_pay.to_i%></span>)
              </label>
          <%end%>
          <label class="radio">
            <%=f.radio_button :pay_app_id, "ips", { :checked=>(@order.payment == 'ips') }%> <b>环迅人民币支付</b>
            <span class="extra-desc"></span>
          </label>
          <div  style="display:none">
            <label class="radio">
              <%=f.radio_button :pay_app_id, "bcom", { :checked=>(@order.payment == 'bcom'),:id=>"bcom_payment",:'data-amount'=>(@order.total_amount*0.05).round }%> <b>交通银行网上支付</b>
              <span class="extra-desc">持交通银行卡在线支付可享受订单金额95折优惠</span>
            </label>
            <label class="radio">
              <%=f.radio_button :pay_app_id, "icbc", { :checked=>(@order.payment == 'icbc') }%> <b>工商银行网上支付</b>
				<span class="extra-desc">
					<input id="installment_on"  type="checkbox" value="1">
					申请分期付款 (<span class="highlight">申请信用卡分期付款，超低手续费，月还款无压力！</span>)
				</span>
				<span id="installment_select" class="hide">
					请选择适合您的期数:
                  <%=f.select :installment,[3,6,9,12,18,24],{:include_blank=>"请选择"}%>期
				</span>
            </label>
            <label class="radio">
              <%=f.radio_button :pay_app_id, "99bill", { :checked=>(@order.payment == '99bill') }%> <b>其他银行网上支付</b>
            </label>
          </div>
          <%if @user.advance >= @order.final_amount%>
              <label class="radio">
                <%=f.radio_button :pay_app_id, "deposit", { :checked=>(@order.payment == 'deposit') } %> <b>预存款</b>
              </label>
          <%end%>

          <label class="radio">
            <%=f.radio_button :pay_app_id, "offline", { :checked=>(@order.payment == 'offline') }%> <b>货到付款</b>
            <span class="extra-desc"><%=link_to "点击查询货到付款配送区域","http://www.zjs.com.cn/WS_Business/WS_Bussiness_CityArea.aspx?id=6",:target=>"_blank"%></span>
          </label>

          <label class="radio">
            <%=f.radio_button :pay_app_id, "alipay", { :checked=>(@order.payment == 'alipay') }%> <b>支付宝</b>
          </label>
          <label class="radio">
            <%=f.radio_button :pay_app_id, "alipaywap", { :checked=>(@order.payment == 'alipaywap') }%> <b>支付宝手机版</b>
          </label>
          <label class="radio">
            <%=f.radio_button :pay_app_id, "wxpay", { :checked=>(@order.payment == 'weixin') }%> <b>微信支付</b>
          </label>
        </div>

        <br/>
        <br/>

        <div class="actions">
          <div class="list_status">

            <h2 class="blue" style="color: #0abede">
              <span class="pay_icon"></span>
              <span >支付成功后，可以在<a href="/orders/norsh_show_order?id=<%=@order.order_id%>">订单详细</a> 处查看订单和追踪订单状态</span>
            </h2>
          </div>
          <br>
          <% if @order.order_status_text=="待付款" %>
              <%=f.submit "安全支付",:class=>"btn  btn-inverse" if @order.pay_status == '0' && @order.status == 'active' && @order.payment != 'offline' %>
          <% else%>
              <span>您已经成功支付了</span>
          <% end %>
        </div>
  <%end%>
  </div>

  <script type="application/javascript">
      $(document).ready(function(){
          $("#change_payment").click(function(){

              if($('#payment_choices').is(':hidden')){
                  $('#payment_choices').show() ;
              }
              else{
                  $('#payment_choices').hide() ;
              }
          })
      })


  </script>
