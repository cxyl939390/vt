<style>
    input.textcenter {
        text-align: center;
        position: relative;
        margin: 0 auto;
        width: 40px;
        border: solid 1px #ccc;
    }
    .bottomdiv {
        position: fixed;
        bottom: 0;
        width: 100%;
        background: #fff;
        border: #ddd 1px solid;
        border-top: #fff 1px solid;
        z-index: 1000000;
    }
    .btn_sure {
        box-shadow: 0 1px 1px rgba(0,0,0,.2);
        color: #fff;
        width: 150px;
        float: right;
        filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff3c9b',endColorstr='#e61f80');
        background: -ms-linear-gradient(top,#ff3c9b,#e61f80);
        background: -moz-linear-gradient(top,#ff3c9b,#e61f80);
        background: -webkit-gradient(linear,0 0,0 100%,from(#ff3c9b),to(#e61f80));
        border: #db207b 1px solid!important;
        cursor: pointer;
    }
    .bottomdivs{
        display: none;
    }
    .btn_cancel, .btn_ensure, .btn_gry, .btn_red, .btn_sure, .btn_unav, .btn_white, .btn_white_order {
        font-weight: 400;
        height: 35px;
        text-align: center;
        font-size: 16px;
        line-height: 35px;
        border-radius: 2px;
        display: inline-block;

    }
    .am-tabs-warning{
        display: none;
    }
</style>

<div class="am-panel am-panel-success" style="text-align: center">
  <div class="am-panel-hd">购物车</div>

</div>
<div id="cart">
  <div class="am-list-news-bd">
    <ul class="am-list">

      <%@line_items.select{ |x| x.good.present? && x.product.present? }.each do |line_item|%>
          <div style="background: #f0f1ff" id="line_<%=line_item.obj_ident%>">
            <li class="am-g am-list-item-desced am-list-item-thumbed am-list-item-thumb-left">
              <div class="am-col col-sm-4 am-list-thumb">
                <a href="\mproducts?id=<%=line_item.good.bn%>&supplier_id=<%=@supplier.id%> class="cart_orderlist_i">
                <img src="<%=line_item.good.medium_pic%>"
                     data-original="<%=line_item.good.medium_pic%>"
                     data-onerror="<%=line_item.good.medium_pic%>"
                     data-brandlazy="true" style="display: inline;">
                </a>
              </div>
              <div class="am-col col-sm-8 am-list-main">
                <h3 class="am-list-item-hd">
                  <a href="\mproducts?id=<%=line_item.good.bn%>&supplier_id=<%=@supplier.id%>">
                    <p class="cart_g_name"><%=line_item.good.brand.brand_name%>,<%=line_item.product.name%> </p>

                  </a>
                </h3>
                <div class="am-list-item-text">
                  <div class="good_data_num J_pro_num_btn_cart" data-product="68671252" style="border:none;height:33px;">
            	 <span class="good_data_num_l J_num_cart_reduce" >
            	 	<a href="javascript:;" mars_sead="cart_edit_btn" style="display: none" data_mars="prd_id:26038564">-</a>
				 </span>
            <span class="good_data_num_l J_num_cart_reduce" >
            	 	数量：
				 </span>
                    <em class="good_data_num_m J_num_cart_txt">
                      <%=number_field_tag :quantity,line_item.quantity.to_i,:class=>"textcenter quantity good_data_num_m J_num_cart_txt",:size=>3,:min=>1,:'data-url'=>cart_path(line_item.obj_ident)%>
                    </em>
				 <span class="good_data_num_r J_num_cart_add" onclick="VsmCart.addNum(this)" >
				 	<a href="javascript:;" mars_sead="cart_edit_btn"  style="display: none" data_mars="prd_id:26038564">+</a>
				</span>
                    <span style="float: right">¥<%= format('%.2f',line_item.good.price)%></span>

                  </div>
                </div>


              </div>

              <div>
        <span class="delete" style="float: right">

           <a href="<%="#{cart_path(line_item.obj_ident)}?platform=mobile"%>" class="delete" data-method="delete" data-remote="true" rel="nofollow"  mars_sead="cart_delect_btn">

             <img src="/assets/mobile/scan_layer-33.png" width="30" height="30">
           </a>
		</span>
              </div>


            </li>
            <hr data-am-widget="divider" style="" class="am-divider am-divider-default am-no-layout">
          </div>
      <%end%>
    </ul>
  </div>












  <div class="bottomdiv clearfix">
    <div class="inner clearfix">
      <div class="fl" style="float: left">
        <p class="cart_total modal-footer" style="color: red">总金额：<span class="c_t_price total">¥<%= format('%.2f',@cart_total)%> </span></p>
      </div>
      <a href="/orders/new_mobile" data-islogin="true" class="fr btn_sure" data-shopcarthide="true" data-counttime="true" data-carttime="1196">
        去结算
      <span class="fr cart_time_smb"><span class="clockicon fl"></span>
        <span class="num_cunt"><span class=":">19</span><span>:</span><span>42</span><span></span></span></span>
      </a>
    </div>
  </div>
</div>

<%= javascript_include_tag "jquery", "jquery_ujs" %>
<script>

    $(document).ready(function(){

        $(" .quantity").on("change",function(){
            var quantity = $(this).val();
            if(!/\d+/.test(quantity)) return false;
            var url = $(this).data('url');
            $.ajax(url,{
                type: "PUT",
                data:{ quantity:quantity },
                success:function(res){
                }
            });
        });
    });
</script>